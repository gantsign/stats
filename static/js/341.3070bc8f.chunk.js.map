{"version":3,"file":"static/js/341.3070bc8f.chunk.js","mappings":"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","sources":["stats/ui/DownloadChart.tsx","stats/ui/DownloadsDialog.tsx"],"sourcesContent":["import * as React from 'react';\nimport createPlotlyComponent from 'react-plotly.js/factory';\nimport {IDataFrame} from 'data-forge';\nimport Measure, {ContentRect} from 'react-measure';\n\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst Plotly = require('plotly.js-basic-dist');\nconst Plot = createPlotlyComponent(Plotly);\n\ninterface DownloadChartProps {\n  downloadsDf: IDataFrame;\n\n  repositoryName: string;\n\n  variant: 'count' | 'delta';\n}\n\ninterface DownloadChartState {\n  width: number;\n\n  height: number;\n}\n\nclass DownloadChart extends React.Component<DownloadChartProps, DownloadChartState> {\n  onResize = (dimensions: ContentRect) => {\n    const bounds = dimensions.bounds;\n    if (!bounds) {\n      return;\n    }\n    this.setState({\n      width: bounds.width,\n      height: bounds.height,\n    });\n  };\n\n  render(): React.ReactNode {\n    const repositoryName = this.props.repositoryName;\n\n    const variant = this.props.variant;\n\n    const columnName = variant === 'count' ? 'downloads_count' : 'downloads_delta';\n    const variantLabel = variant === 'count' ? 'Download count' : 'Downloads / day';\n\n    const downloadsDf = this.props.downloadsDf\n      .where(row => row.repository_name === repositoryName)\n      .setIndex('data_at')\n      .subset([columnName]);\n\n    // eslint-disable-next-line no-undef\n    const data: Plotly.Data[] = [\n      {\n        x: downloadsDf.getIndex().toArray(),\n        y: downloadsDf.getSeries(columnName).toArray(),\n        type: 'scatter',\n      },\n    ];\n    return (\n      <Measure bounds onResize={this.onResize}>\n        {({measureRef}) => {\n          const state: DownloadChartState = this.state || {\n            width: 800,\n            height: 600,\n          };\n          // eslint-disable-next-line no-undef\n          const layout: Partial<Plotly.Layout> = {\n            width: state.width,\n            height: state.height,\n            title: repositoryName,\n            xaxis: {title: 'Date'},\n            yaxis: {title: variantLabel},\n          };\n          return (\n            <div ref={measureRef} style={{height: '100%'}}>\n              <Plot data={data} layout={layout} />\n            </div>\n          );\n        }}\n      </Measure>\n    );\n  }\n}\n\nexport default DownloadChart;\n","import * as React from 'react';\nimport {\n  AppBar,\n  Dialog,\n  IconButton,\n  InputLabel,\n  MenuItem,\n  MuiThemeProvider,\n  Select,\n  Slide,\n  Theme,\n  Toolbar,\n  withStyles,\n  WithStyles,\n} from '@material-ui/core';\nimport {TransitionProps} from '@material-ui/core/transitions';\nimport {DownloadSnapshot} from '../model/DownloadSnapshot';\nimport * as DataForge from 'data-forge';\nimport {IDataFrame} from 'data-forge';\nimport DownloadChart from './DownloadChart';\nimport {darkTheme} from './App';\nimport CloseIcon from '@material-ui/icons/Close';\nimport {StyleRules} from '@material-ui/core/styles';\n\ninterface DownloadsDialogProps extends WithStyles {\n  repositoryName: string | null;\n\n  downloads: DownloadSnapshot[];\n\n  open: boolean;\n\n  onClose?: React.ReactEventHandler<{}>;\n}\n\ninterface DownloadsDialogState {\n  repositoryName?: string | null;\n\n  variant: 'count' | 'delta';\n}\n\nfunction DialogTransition(props: TransitionProps) {\n  return <Slide direction=\"up\" {...props} />;\n}\n\nclass DownloadsDialogBase extends React.Component<DownloadsDialogProps, DownloadsDialogState> {\n  componentDidMount(): void {\n    this.setState({\n      repositoryName: this.props.repositoryName,\n      variant: 'count',\n    });\n  }\n\n  componentDidUpdate(prevProps: Readonly<DownloadsDialogProps>): void {\n    if (prevProps.repositoryName !== this.props.repositoryName) {\n      this.setState({\n        repositoryName: this.props.repositoryName,\n        variant: 'count',\n      });\n    }\n  }\n\n  repoChanged = (event: React.ChangeEvent<{name?: string; value: unknown}>) => {\n    const state = this.state;\n    if (!state) {\n      return;\n    }\n    const repositoryName = String(event.target.value);\n    const variant = state.variant;\n\n    this.setState({\n      repositoryName,\n      variant,\n    });\n  };\n\n  variantChanged = (event: React.ChangeEvent<{name?: string; value: unknown}>) => {\n    const state = this.state;\n    if (!state) {\n      return;\n    }\n    const repositoryName = state.repositoryName;\n    const variant: 'count' | 'delta' = event.target.value === 'count' ? 'count' : 'delta';\n\n    this.setState({\n      repositoryName,\n      variant,\n    });\n  };\n\n  render(): React.ReactNode {\n    const state = this.state;\n    if (!state) {\n      return <></>;\n    }\n\n    const downloads = this.props.downloads;\n\n    const repositoryName = state.repositoryName || '';\n    const variant = state.variant;\n\n    const downloadsDf: IDataFrame = new DataForge.DataFrame({\n      values: downloads,\n    }).parseDates(['data_at']);\n\n    const repoNames: string[] = downloadsDf\n      .getSeries('repository_name')\n      .distinct()\n      .toArray()\n      .sort((nameA: string, nameB: string): number => {\n        const nameNormA = nameA.replace('_', '-');\n        const nameNormB = nameB.replace('_', '-');\n        return nameNormA.localeCompare(nameNormB);\n      });\n\n    const open = this.props.open;\n\n    const classes = this.props.classes;\n\n    return (\n      <Dialog open={open} fullScreen={true} TransitionComponent={DialogTransition}>\n        <AppBar position=\"static\">\n          <Toolbar>\n            <MuiThemeProvider theme={darkTheme}>\n              <IconButton aria-label=\"Close\" className={classes.closeButton} onClick={this.props.onClose}>\n                <CloseIcon />\n              </IconButton>\n              <InputLabel htmlFor=\"repo\">Repository</InputLabel>&nbsp;\n              <Select\n                value={repositoryName}\n                onChange={this.repoChanged}\n                inputProps={{\n                  name: 'repo',\n                  id: 'repo',\n                }}\n              >\n                {repoNames.map(name => (\n                  <MenuItem key={name} value={name}>\n                    {name}\n                  </MenuItem>\n                ))}\n              </Select>\n              &nbsp;&nbsp;\n              <InputLabel htmlFor=\"variant\">View</InputLabel>&nbsp;\n              <Select\n                value={variant}\n                onChange={this.variantChanged}\n                inputProps={{\n                  name: 'variant',\n                  id: 'variant',\n                }}\n              >\n                <MenuItem value=\"count\">Download count</MenuItem>\n                <MenuItem value=\"delta\">Downloads / day</MenuItem>\n              </Select>\n            </MuiThemeProvider>\n          </Toolbar>\n        </AppBar>\n        {(() => {\n          if (!repositoryName) {\n            return <></>;\n          }\n          return <DownloadChart downloadsDf={downloadsDf} repositoryName={repositoryName} variant={variant} />;\n        })()}\n      </Dialog>\n    );\n  }\n}\n\nconst styles = (theme: Theme): StyleRules => ({\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n  },\n});\nconst DownloadsDialog = withStyles(styles)(DownloadsDialogBase);\n\nexport default DownloadsDialog;\n"],"names":["Plotly","require","Plot","createPlotlyComponent","DownloadChart","_React$Component","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","onResize","dimensions","bounds","setState","width","height","_createClass","key","value","_this2","repositoryName","this","props","variant","columnName","variantLabel","downloadsDf","where","row","repository_name","setIndex","subset","data","x","getIndex","toArray","y","getSeries","type","_jsx","Measure","children","_ref","measureRef","state","layout","title","xaxis","yaxis","ref","style","React","DialogTransition","Slide","_objectSpread","direction","DownloadsDialogBase","repoChanged","event","String","target","variantChanged","prevProps","_Fragment","downloads","DataForge","values","parseDates","repoNames","distinct","sort","nameA","nameB","nameNormA","replace","nameNormB","localeCompare","open","classes","_jsxs","Dialog","fullScreen","TransitionComponent","AppBar","position","Toolbar","MuiThemeProvider","theme","darkTheme","IconButton","className","closeButton","onClick","onClose","CloseIcon","InputLabel","htmlFor","Select","onChange","inputProps","name","id","map","MenuItem","withStyles","right","spacing","top"],"sourceRoot":""}